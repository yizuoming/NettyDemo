Message-ID: <312469802.2424002.1555898367366.JavaMail.admin@A01-R04-I227-85.JD.LOCAL>
Subject: Exported From Confluence
MIME-Version: 1.0
Content-Type: multipart/related; 
	boundary="----=_Part_2424001_1770717693.1555898367365"

------=_Part_2424001_1770717693.1555898367365
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Content-Location: file:///C:/exported.html

<html xmlns:o=3D'urn:schemas-microsoft-com:office:office'
      xmlns:w=3D'urn:schemas-microsoft-com:office:word'
      xmlns:v=3D'urn:schemas-microsoft-com:vml'
      xmlns=3D'urn:w3-org-ns:HTML'>
<head>
    <meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf-8=
">
    <title>=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=83=
=E7=A0=94</title>
    <!--[if gte mso 9]>
    <xml>
        <o:OfficeDocumentSettings>
            <o:TargetScreenSize>1024x640</o:TargetScreenSize>
            <o:PixelsPerInch>72</o:PixelsPerInch>
            <o:AllowPNG/>
        </o:OfficeDocumentSettings>
        <w:WordDocument>
            <w:View>Print</w:View>
            <w:Zoom>90</w:Zoom>
            <w:DoNotOptimizeForBrowser/>
        </w:WordDocument>
    </xml>
    <![endif]-->
    <style>
                <!--
        @page Section1 {
            size: 8.5in 11.0in;
            margin: 1.0in;
            mso-header-margin: .5in;
            mso-footer-margin: .5in;
            mso-paper-source: 0;
        }

        table {
            border: solid 1px;
            border-collapse: collapse;
        }

        table td, table th {
            border: solid 1px;
            padding: 5px;
        }

        td {
            page-break-inside: avoid;
        }

        tr {
            page-break-after: avoid;
        }

        div.Section1 {
            page: Section1;
        }

        /* Confluence print stylesheet. Common to all themes for print medi=
a */
/* Full of !important until we improve batching for print CSS */

@media print {
    #main {
        padding-bottom: 1em !important; /* The default padding of 6em is to=
o much for printouts */
    }

    body {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        font-size: 10pt;
        line-height: 1.2;
    }

    body, #full-height-container, #main, #page, #content, .has-personal-sid=
ebar #content {
        background: #fff !important;
        color: #000 !important;
        border: 0 !important;
        width: 100% !important;
        height: auto !important;
        min-height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        display: block !important;
    }

    a, a:link, a:visited, a:focus, a:hover, a:active {
        color: #000;
    }

    #content h1,
    #content h2,
    #content h3,
    #content h4,
    #content h5,
    #content h6 {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        page-break-after: avoid;
    }

    pre {
        font-family: Monaco, "Courier New", monospace;
    }

    #header,
    .aui-header-inner,
    #navigation,
    #sidebar,
    .sidebar,
    #personal-info-sidebar,
    .ia-fixed-sidebar,
    .page-actions,
    .navmenu,
    .ajs-menu-bar,
    .noprint,
    .inline-control-link,
    .inline-control-link a,
    a.show-labels-editor,
    .global-comment-actions,
    .comment-actions,
    .quick-comment-container,
    #addcomment {
        display: none !important;
    }

    /* CONF-28544 cannot print multiple pages in IE */
    #splitter-content {
        position: relative !important;
    }

    .comment .date::before {
        content: none !important; /* remove middot for print view */
    }

    h1.pagetitle img {
        height: auto;
        width: auto;
    }

    .print-only {
        display: block;
    }

    #footer {
        position: relative !important; /* CONF-17506 Place the footer at en=
d of the content */
        margin: 0;
        padding: 0;
        background: none;
        clear: both;
    }

    #poweredby {
        border-top: none;
        background: none;
    }

    #poweredby li.print-only {
        display: list-item;
        font-style: italic;
    }

    #poweredby li.noprint {
        display: none;
    }

    /* no width controls in print */
    .wiki-content .table-wrap,
    .wiki-content p,
    .panel .codeContent,
    .panel .codeContent pre,
    .image-wrap {
        overflow: visible !important;
    }

    /* TODO - should this work? */
    #children-section,
    #comments-section .comment,
    #comments-section .comment .comment-body,
    #comments-section .comment .comment-content,
    #comments-section .comment p {
        page-break-inside: avoid;
    }

    #page-children a {
        text-decoration: none;
    }

    /**
     hide twixies

     the specificity here is a hack because print styles
     are getting loaded before the base styles. */
    #comments-section.pageSection .section-header,
    #comments-section.pageSection .section-title,
    #children-section.pageSection .section-header,
    #children-section.pageSection .section-title,
    .children-show-hide {
        padding-left: 0;
        margin-left: 0;
    }

    .children-show-hide.icon {
        display: none;
    }

    /* personal sidebar */
    .has-personal-sidebar #content {
        margin-right: 0px;
    }

    .has-personal-sidebar #content .pageSection {
        margin-right: 0px;
    }

    .no-print, .no-print * {
        display: none !important;
    }
}
-->
    </style>
</head>
<body>
    <h1>=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=83=E7=
=A0=94</h1>
    <div class=3D"Section1">
        <p><strong><style type=3D"text/css">/*<![CDATA[*/
div.rbtoc1555898367261 {padding: 0px;}
div.rbtoc1555898367261 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1555898367261 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style></strong></p>
<div class=3D"toc-macro rbtoc1555898367261">
<strong>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-1.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=B0=
=E8=B0=83=E7=A0=94=E8=8C=83=E5=9B=B4">1.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=
=81=E5=AE=9E=E7=8E=B0=E8=B0=83=E7=A0=94=E8=8C=83=E5=9B=B4</a></li>=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-2.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=B0=
=E4=BB=8B=E7=BB=8D">2.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=
=B0=E4=BB=8B=E7=BB=8D</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-2.1.Redis=E5=AE=9E=E7=8E=B0">2.1.Redis=E5=AE=9E=E7=8E=B0=
</a></li>=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-2.2.Zk=E5=AE=98=E6=96=B9API=E5=AE=9E=E7=8E=B0">2.2. Zk=
=E5=AE=98=E6=96=B9API=E5=AE=9E=E7=8E=B0</a></li>=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-2.2.ApacheCurator=E5=AE=9E=E7=8E=B0">2.2. Apache Curator=
=E5=AE=9E=E7=8E=B0</a></li>=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-2.3.=E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=90=E7=9A=84SharkLo=
ck=E5=AE=9E=E7=8E=B0">2.3. =E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=90=E7=9A=84Sha=
rkLock=E5=AE=9E=E7=8E=B0</a></li>=20
</ul> </li>=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-3.=E8=B0=83=E7=A0=94=E7=BB=93=E8=AE=BA">3.=E8=B0=83=E7=
=A0=94=E7=BB=93=E8=AE=BA</a></li>=20
<li><a href=3D"#id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=
=E8=B0=83=E7=A0=94-4.Curator=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E6=8E=A5=
=E5=85=A5=E9=A1=B9=E7=9B=AE">4.Curator=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=
=E6=8E=A5=E5=85=A5=E9=A1=B9=E7=9B=AE</a></li>=20
</ul> </strong>
</div>
<strong><br></strong>
<p></p>
<h2 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-1.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=B0=E8=B0=
=83=E7=A0=94=E8=8C=83=E5=9B=B4"><strong>1.</strong><strong style=3D"letter-=
spacing: -0.008em;">=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=B0=
=E8=B0=83=E7=A0=94=E8=8C=83=E5=9B=B4</strong></h2>
<ul>
<li><p>Redis=E5=AE=9E=E7=8E=B0</p></li>
<li><p>Zookeeper=E5=AE=98=E6=96=B9API=E5=AE=9E=E7=8E=B0</p></li>
<li><p>=E5=BC=80=E6=BA=90=E6=A1=86=E6=9E=B6Apache Curator=E5=AE=9E=E7=8E=B0=
</p></li>
<li><p>=E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=90=E6=A1=86=E6=9E=B6sharkLock=E5=
=AE=9E=E7=8E=B0</p></li>
</ul>
<h2 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-2.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=B0=E4=BB=
=8B=E7=BB=8D"><strong>2.=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=9E=E7=8E=
=B0=E4=BB=8B=E7=BB=8D</strong></h2>
<h3 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-2.1.Redis=E5=AE=9E=E7=8E=B0">2.1.Redis=E5=AE=9E=E7=8E=B0</h3>
<p><strong>1</strong><strong>=EF=BC=89=E5=AE=9E=E7=8E=B0=E6=80=9D=E8=B7=AF<=
/strong></p>
<p>redis2.6.12=E7=89=88=E6=9C=AC=E4=B9=8B=E5=89=8D=E4=B8=BB=E8=A6=81=E5=87=
=AD=E5=80=9FSETNX=E5=8F=8AEXPIRE=E5=91=BD=E4=BB=A4=E9=85=8D=E5=90=88=E4=BD=
=BF=E7=94=A8=E6=9D=A5=E5=AE=9E=E7=8E=B0=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=
=EF=BC=8C=E4=BD=86=E6=98=AF=E8=AF=A5=E5=8A=A0=E9=94=81=E6=93=8D=E4=BD=9C=E4=
=B8=8D=E5=85=B7=E5=A4=87=E5=8E=9F=E5=AD=90=E6=80=A7=EF=BC=8C=E4=B8=80=E5=AE=
=9A=E7=A8=8B=E5=BA=A6=E4=B8=8A=E5=8F=AF=E8=83=BD=E5=AF=BC=E8=87=B4=E6=AD=BB=
=E9=94=81=EF=BC=9B</p>
<p>redis2.6.12=E7=89=88=E6=9C=AC=E4=B9=8B=E5=90=8E=E5=A2=9E=E5=BC=BA=E4=BA=
=86SET=E5=91=BD=E4=BB=A4=EF=BC=8C=E5=88=A9=E7=94=A8=E9=99=84=E5=8A=A0=E5=8F=
=82=E6=95=B0=E5=AE=9E=E7=8E=B0=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E7=9A=84=
=E5=90=8C=E6=97=B6=E4=BF=9D=E8=AF=81=E5=8A=A0=E9=94=81=E6=93=8D=E4=BD=9C=E7=
=9A=84=E5=8E=9F=E5=AD=90=E6=80=A7=EF=BC=9B</p>
<div class=3D"table-wrap">
<table class=3D"wrapped confluenceTable">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class=3D"confluenceTd"><p>=E5=91=BD=E4=BB=A4</p></td>
<td class=3D"confluenceTd"><p>=E5=8F=82=E6=95=B0=E8=A7=A3=E9=87=8A</p></td>
</tr>
<tr>
<td rowspan=3D"4" class=3D"confluenceTd"><p align=3D"left"><strong>SET key =
value [EX seconds] [PX milliseconds] [NX|XX]</strong></p></td>
<td class=3D"confluenceTd"><p>EX second=EF=BC=9A=E8=AE=BE=E7=BD=AE=E9=94=AE=
=E7=9A=84=E8=BF=87=E6=9C=9F=E6=97=B6=E9=97=B4=E4=B8=BAsecond=E7=A7=92</p></=
td>
</tr>
<tr>
<td class=3D"confluenceTd"><p>PX millisecon=EF=BC=9A=E8=AE=BE=E7=BD=AE=E9=
=94=AE=E7=9A=84=E8=BF=87=E6=9C=9F=E6=97=B6=E9=97=B4=E4=B8=BAmillisecond=E6=
=AF=AB=E7=A7=92</p></td>
</tr>
<tr>
<td class=3D"confluenceTd"><p><span style=3D"color: rgb(255,0,0);">NX=EF=BC=
=9A=E5=8F=AA=E5=9C=A8=E9=94=AE=E4=B8=8D=E5=AD=98=E5=9C=A8=E6=97=B6=EF=BC=8C=
=E6=89=8D=E5=AF=B9=E9=94=AE=E8=BF=9B=E8=A1=8C=E8=AE=BE=E7=BD=AE=E6=93=8D=E4=
=BD=9C</span></p></td>
</tr>
<tr>
<td class=3D"confluenceTd"><p>XX=EF=BC=9A=E5=8F=AA=E5=9C=A8=E9=94=AE=E5=B7=
=B2=E7=BB=8F=E5=AD=98=E5=9C=A8=E6=97=B6=EF=BC=8C=E6=89=8D=E5=AF=B9=E9=94=AE=
=E8=BF=9B=E8=A1=8C=E8=AE=BE=E7=BD=AE=E6=93=8D=E4=BD=9C</p></td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<p>=E9=97=AE=E9=A2=98=EF=BC=9A=E4=B8=80=E8=88=AC=E6=83=85=E5=86=B5=E4=B8=8B=
redis=E5=8F=AF=E4=BB=A5=E6=BB=A1=E8=B6=B3=E4=B8=9A=E5=8A=A1=E5=9C=BA=E6=99=
=AF=EF=BC=8C=E4=BD=86=E6=98=AF=E5=9C=A8=E6=89=A7=E8=A1=8C=E8=80=97=E6=97=B6=
=E8=BE=83=E9=95=BF=E7=9A=84=E4=BB=BB=E5=8A=A1=E6=97=B6(=E4=BE=8B=E5=A6=82=
=E5=9B=BD=E9=99=85=E9=85=92=E5=BA=97=E5=9B=BE=E7=89=87=E8=90=BD=E5=9C=B0=E5=
=AE=9A=E6=97=B6=E4=BB=BB=E5=8A=A1=E8=80=97=E6=97=B620=E5=A4=A9)=EF=BC=8C=E9=
=9C=80=E8=A6=81=E4=B8=BA=E9=94=81=E6=B7=BB=E5=8A=A0=E5=BE=88=E9=95=BF=E7=9A=
=84=E8=B6=85=E6=97=B6=E6=97=B6=E9=97=B4=EF=BC=8C=E4=B8=80=E6=96=B9=E9=9D=A2=
=E6=97=B6=E9=97=B4=E6=AF=94=E8=BE=83=E9=9A=BE=E4=BC=B0=E7=AE=97=EF=BC=8C</p=
>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=E5=8F=A6=E4=B8=80=E6=96=B9=E9=
=9D=A2=EF=BC=8C=E8=8B=A5=E4=B8=AD=E9=80=94=E5=AE=95=E6=9C=BA=E6=88=96=E6=9C=
=8D=E5=8A=A1=E9=87=8D=E5=90=AF=EF=BC=8C=E9=83=BD=E9=9C=80=E8=A6=81=E5=9C=A8=
JIMDB=E7=AE=A1=E7=90=86=E9=A1=B5=E9=9D=A2=E6=89=8B=E5=8A=A8=E9=87=8A=E6=94=
=BE=E9=94=81=EF=BC=8C=E8=BF=99=E9=9C=80=E8=A6=81=E5=AF=B9=E4=B8=9A=E5=8A=A1=
=E7=9B=B8=E5=AF=B9=E7=86=9F=E6=82=89=E6=89=8D=E8=83=BD=E7=9F=A5=E9=81=93=E6=
=9C=89=E5=A4=9A=E5=B0=91=E5=8F=97=E5=BD=B1=E5=93=8D=E7=9A=84=E9=94=81=EF=BC=
=8C=E6=93=8D=E4=BD=9C=E5=85=B7=E6=9C=89=E4=B8=80=E5=AE=9A=E9=9A=BE=E5=BA=A6=
=E3=80=82</p>
<p>=E4=BC=98=E5=8C=96=EF=BC=9A=E5=AF=B9=E4=BA=8E=E7=B1=BB=E4=BC=BC=E4=B8=9A=
=E5=8A=A1=E5=9C=BA=E6=99=AF=EF=BC=8C=E5=9C=A8=E6=B7=BB=E5=8A=A0=E9=94=81=E6=
=97=B6=E5=88=9D=E5=A7=8B=E8=AE=BE=E7=BD=AE=E4=B8=80=E4=B8=AA=E8=BE=83=E7=9F=
=AD=E7=9A=84=E6=97=B6=E9=97=B4=EF=BC=8C=E5=86=8D=E9=A2=9D=E5=A4=96=E5=BC=80=
=E5=90=AF=E4=B8=80=E4=B8=AA=E5=AE=88=E6=8A=A4=E7=BA=BF=E7=A8=8B=EF=BC=8C=E5=
=9C=A8=E5=BD=93=E5=89=8D=E9=94=81=E5=BF=AB=E8=BF=87=E6=9C=9F=E6=97=B6=E5=86=
=8D=E4=B8=BA=E5=85=B6=E8=AE=BE=E7=BD=AE=E4=B8=80=E4=B8=AA=E8=BF=87=E6=9C=9F=
=E6=97=B6=E9=97=B4=EF=BC=8C=E7=9B=B4=E8=87=B3=E4=BB=BB=E5=8A=A1=E6=89=A7=E8=
=A1=8C=E5=AE=8C=E6=88=90=E3=80=82</p>
<p>=E5=A5=BD=E5=A4=84=EF=BC=9A=E5=9B=A0=E4=B8=BA=E4=BB=BB=E5=8A=A1=E6=89=A7=
=E8=A1=8C=E8=BF=87=E7=A8=8B=E4=B8=AD=E6=AF=8F=E6=AC=A1=E8=AE=BE=E7=BD=AE=E7=
=9A=84=E8=BF=87=E6=9C=9F=E6=97=B6=E9=97=B4=E9=83=BD=E5=BE=88=E7=9F=AD=EF=BC=
=8C=E5=AE=95=E6=9C=BA=E6=88=96=E9=87=8D=E5=90=AF=E6=97=B6=E7=AD=89=E5=BE=85=
=E9=94=81=E8=BF=87=E6=9C=9F=E5=8D=B3=E5=8F=AF=EF=BC=9B=E3=80=90=E6=B3=A8=EF=
=BC=9A=E7=AC=AC=E4=B8=89=E6=96=B9=E5=B7=A5=E5=85=B7redisson=E5=B7=B2=E5=AE=
=9E=E7=8E=B0=E7=B1=BB=E4=BC=BC=E5=8A=9F=E8=83=BD=EF=BC=8C=E5=8F=AF=E5=8F=82=
=E8=80=83<a href=3D"https://github.com/redisson/redisson" class=3D"external=
-link" rel=3D"nofollow">https://github.com/redisson/redisson</a>=E3=80=91</=
p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">=E5=AE=9E=E7=8E=B0Demo</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">@Service
public class RedisLockDemo {
    @Autowired
    private JimCache jimCache;
    @Autowired
    DaemonThread daemonThread;

    public Boolean lock(String key, Long seconds) {
        Boolean setSucceed =3D jimCache.setNX(key, "true", seconds);
        if (setSucceed) {
            daemonThread.addKey(key);
        }
        return setSucceed;
    }

    public void unLock(String key) {
        //=E5=88=A0=E9=99=A4=E7=BC=93=E5=AD=98=E5=92=8C=E5=88=A0=E9=99=A4li=
st=E5=85=83=E7=B4=A0=E6=93=8D=E4=BD=9C=E5=AD=98=E5=9C=A8=E5=8E=9F=E5=AD=90=
=E6=80=A7=E9=97=AE=E9=A2=98
 =09=09Boolean setSucceed =3D jimCache.expire(key, 0);
        if (setSucceed) {
            daemonThread.deleteKey(key);
        }
    }
}

//=E5=AE=88=E6=8A=A4=E7=BA=BF=E7=A8=8B
@Service
public class DaemonThread implements InitializingBean {
    @Autowired
    private JimCache jimCache;
    private static List&lt;String&gt; keyList =3D new CopyOnWriteArrayList&=
lt;&gt;();

    @Override
    public void afterPropertiesSet() {
        new Thread(new Runnable() {
            @Override
            public void run() {
                while (true) {
                    try {
                        TimeUnit.SECONDS.sleep(3);
                    } catch (Exception e) {
                    }
                    keyList.stream().forEach(lockName -&gt; {
                        if (jimCache.exists(lockName)) {
                            jimCache.expire(lockName, 5, TimeUnit.SECONDS);
                        }
                    });
                }
            }
        }).start();
    }

    public void deleteKey(String key) {
        keyList.remove(key);
    }

    public void addKey(String key) {
        keyList.add(key);
    }
}</pre>=20
</div>=20
</div>
<p><strong>2</strong><strong>=EF=BC=89=E4=BC=98=E7=82=B9</strong></p>
<ul>
<li>=E6=80=A7=E8=83=BD=E8=BE=83=E5=A5=BD=EF=BC=8C=E5=AE=9E=E7=8E=B0=E7=AE=
=80=E5=8D=95=EF=BC=9B</li>
</ul>
<p><strong>3=EF=BC=89=E7=BC=BA=E7=82=B9</strong></p>
<ul>
<li>=E4=B8=9A=E5=8A=A1=E5=9C=BA=E6=99=AF=E4=B8=AD=E5=AF=B9=E4=BA=8E=E9=98=
=BB=E5=A1=9E=E9=94=81=E7=9A=84=E5=AE=9E=E7=8E=B0=EF=BC=8C=E4=B8=80=E8=88=AC=
=E4=BD=BF=E7=94=A8while=E5=BE=AA=E7=8E=AF=E5=AE=9A=E6=97=B6=E5=B0=9D=E8=AF=
=95=E8=8E=B7=E5=8F=96=E9=94=81=E3=80=82=E8=8B=A5=E5=B7=B2=E8=8E=B7=E5=8F=96=
=E9=94=81=E7=9A=84=E6=9C=8D=E5=8A=A1=E5=9C=A8=E6=89=A7=E8=A1=8C=E4=BB=BB=E5=
=8A=A1=E8=BF=87=E7=A8=8B=E4=B8=AD=E5=AE=95=E6=9C=BA=EF=BC=8C=E5=88=99=E5=85=
=B6=E4=BB=96=E9=98=BB=E5=A1=9E=E5=BF=85=E9=A1=BB=E7=AD=89=E5=BE=85=E9=94=81=
=E8=B6=85=E6=97=B6=E6=89=8D=E6=9C=89=E5=8F=AF=E8=83=BD=E8=8E=B7=E5=8F=96=E9=
=94=81=EF=BC=9B</li>
</ul>
<h3 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-2.2.Zk=E5=AE=98=E6=96=B9API=E5=AE=9E=E7=8E=B0">2.2. Zk=E5=AE=
=98=E6=96=B9API=E5=AE=9E=E7=8E=B0</h3>
<p><strong>1</strong><strong>=EF=BC=89=E5=AE=9E=E7=8E=B0=E6=80=9D=E8=B7=AF<=
/strong></p>
<p>=E5=9F=BA=E4=BA=8EZookeeper=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=
=E7=82=B9=E5=AE=9E=E7=8E=B0=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E3=80=82=E6=
=AF=8F=E4=B8=AA=E7=BA=BF=E7=A8=8B=E5=8A=A0=E9=94=81=E6=97=B6=EF=BC=8C=E8=8E=
=B7=E5=8F=96=E6=8C=81=E4=B9=85=E5=8C=96=E9=94=81=E8=8A=82=E7=82=B9=E8=B7=AF=
=E5=BE=84=E4=B8=8B=E6=89=80=E6=9C=89=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=
=8A=82=E7=82=B9=EF=BC=8C=E8=8B=A5=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=
=9B=E5=BB=BA=E7=9A=84=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=82=B9=
=E4=B8=BA=E6=9C=80=E5=B0=8F=E8=8A=82=E7=82=B9=EF=BC=8C=E5=88=99=E8=A1=A8=E7=
=A4=BA=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=8A=A0=E9=94=81=E6=88=90=E5=8A=
=9F=EF=BC=9B</p>
<p>=E8=8B=A5=E4=B8=8D=E6=98=AF=E6=9C=80=E5=B0=8F=E8=8A=82=E7=82=B9=EF=BC=8C=
=E5=88=99=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=E5=BB=BA=E7=9A=84=E8=
=8A=82=E7=82=B9=E7=9B=91=E5=90=AC=E6=AF=94=E5=AE=83=E5=B0=8F=E7=9A=84=E6=9C=
=80=E5=A4=A7=E8=8A=82=E7=82=B9=EF=BC=8C=E9=98=BB=E5=A1=9E=E7=AD=89=E5=BE=85=
=E8=A2=AB=E7=9B=91=E5=90=AC=E8=8A=82=E7=82=B9=E7=9A=84=E5=88=A0=E9=99=A4=E9=
=80=9A=E7=9F=A5=EF=BC=8C=E5=BE=85=E5=89=8D=E7=BD=AE=E8=8A=82=E7=82=B9=E5=88=
=A0=E9=99=A4=E5=90=8E=EF=BC=8C=E9=87=8D=E6=96=B0=E5=88=A4=E6=96=AD=E5=BD=93=
=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=E5=BB=BA=E7=9A=84=E8=8A=82=E7=82=B9=E6=
=98=AF=E5=90=A6=E4=B8=BA=E6=9C=80=E5=B0=8F=E8=8A=82=E7=82=B9=EF=BC=8C=E9=87=
=8D=E5=A4=8D=E4=BB=A5=E4=B8=8A=E6=93=8D=E4=BD=9C=EF=BC=9B</p>
<p>=E7=A4=BA=E4=BE=8B=EF=BC=9A</p>
<p><span class=3D"confluence-embedded-file-wrapper confluence-embedded-manu=
al-size"><img class=3D"confluence-embedded-image" height=3D"96" src=3D"fd64=
e7ef48bd8918a9f1ffc8941e28cb" data-image-src=3D"/download/attachments/16221=
5633/image2019-3-1_13-59-33.png?version=3D1&amp;modificationDate=3D15514199=
92000&amp;api=3Dv2" data-unresolved-comment-count=3D"0" data-linked-resourc=
e-id=3D"162230190" data-linked-resource-version=3D"1" data-linked-resource-=
type=3D"attachment" data-linked-resource-default-alias=3D"image2019-3-1_13-=
59-33.png" data-base-url=3D"https://cf.jd.com" data-linked-resource-content=
-type=3D"image/png" data-linked-resource-container-id=3D"162215633" data-li=
nked-resource-container-version=3D"25" width=3D"468"></span></p>
<p>=E4=B8=89=E4=B8=AA=E7=BA=BF=E7=A8=8B=E5=88=86=E5=88=AB=E5=AF=B9=E9=94=81=
=E5=90=8D=E4=B8=BA=E2=80=9Ctest4=E2=80=9D=E5=8A=A0=E9=94=81=EF=BC=8C=E5=88=
=9B=E5=BB=BA=E5=AF=B9=E5=BA=94=E7=9A=84=E4=B8=89=E4=B8=AA=E4=B8=B4=E6=97=B6=
=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=82=B9=EF=BC=9Aclient0000000000=E3=80=81clien=
t0000000001=E3=80=81client0000000002=EF=BC=9B</p>
<ol>
<li>=E9=A6=96=E5=85=88client0000000000=E8=8E=B7=E5=8F=96=E9=94=81=EF=BC=8Cc=
lient0000000001=E7=9B=91=E5=90=ACclient0000000000=EF=BC=8Cclient0000000002=
=E7=9B=91=E5=90=ACclient0000000001=EF=BC=9B</li>
<li>client0000000000=E8=8A=82=E7=82=B9=E5=88=A0=E9=99=A4=E5=90=8E=EF=BC=8C=
=E9=80=9A=E7=9F=A5client0000000001=E5=B0=9D=E8=AF=95=E8=8E=B7=E5=8F=96=E9=
=94=81=EF=BC=9B</li>
<li>client0000000001=E8=8A=82=E7=82=B9=E5=88=A0=E9=99=A4=E5=90=8E=EF=BC=8C=
=E9=80=9A=E7=9F=A5client0000000002=E5=B0=9D=E8=AF=95=E8=8E=B7=E5=8F=96=E9=
=94=81=EF=BC=9B</li>
<li>=E5=BC=82=E5=B8=B8=E6=83=85=E5=86=B5=EF=BC=9A=E8=8B=A5client0000000000=
=E6=8C=81=E6=9C=89=E9=94=81=E6=97=B6=EF=BC=8Cclient0000000001=E8=8A=82=E7=
=82=B9=E5=BC=82=E5=B8=B8=E6=B6=88=E5=A4=B1=EF=BC=8C=E9=82=A3=E4=B9=88client=
0000000002=E8=8A=82=E7=82=B9=E6=A3=80=E6=B5=8B=E5=88=B0client0000000000=E4=
=BB=8D=E5=AD=98=E5=9C=A8=EF=BC=8C=E5=88=99=E8=A6=81=E7=9B=91=E5=90=ACclient=
0000000000=E8=8A=82=E7=82=B9=EF=BC=9B</li>
</ol>
<p><br></p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">=E5=AE=9E=E7=8E=B0Demo</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">import org.apache.commons.lang3.StringUtils;
import org.apache.zookeeper.*;
import org.apache.zookeeper.data.Stat;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.InitializingBean;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.TreeSet;
import java.util.concurrent.CountDownLatch;
import java.util.concurrent.TimeUnit;

@Service
public class ZkLockDemo implements InitializingBean, Watcher {

    private static Logger logger =3D LoggerFactory.getLogger(ZkLockDemo.cla=
ss);

    private static volatile ZooKeeper zk;

    static String zkAddress =3D "192.168.108.28:2181";

    /**
     * =E6=A0=B9=E8=8A=82=E7=82=B9
     */
    private String root =3D "/locksNode";

    /**
     * =E5=AD=98=E5=82=A8=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=E5=
=BB=BA=E7=9A=84=E9=94=81(=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=
=82=B9=E7=9A=84=E5=85=A8=E8=B7=AF=E5=BE=84)
     */
    private ThreadLocal&lt;List&lt;String&gt;&gt; nodePathList =3D new Thre=
adLocal&lt;&gt;();

    public ZkLockDemo() {
    }

    @Override
    public void afterPropertiesSet() {
        createRootNode();
    }

    /**
     * =E5=88=9B=E5=BB=BA=E9=94=81=E7=9A=84=E6=8C=81=E4=B9=85=E5=8C=96=E6=
=A0=B9=E8=8A=82=E7=82=B9
     */
    private void createRootNode() {
        try {
            if (StringUtils.isBlank(zkAddress)) {
                throw new NullPointerException("zooKeeper address conf erro=
r");
            }
            CountDownLatch countDownLatch =3D new CountDownLatch(1);
            //=E5=BB=BA=E7=AB=8Bzk=E8=BF=9E=E6=8E=A5
            logger.info("=E5=BC=80=E5=A7=8B=E8=BF=9E=E6=8E=A5zk", root);
            zk =3D new ZooKeeper(zkAddress, 10000, new Watcher() {
                @Override
                public void process(WatchedEvent event) {
                    if (event.getState() =3D=3D Event.KeeperState.SyncConne=
cted) {
                        countDownLatch.countDown();
                    }
                }
            });
            //=E7=AD=89=E5=BE=85=E9=94=81=E8=BF=9E=E6=8E=A5=E6=88=90=E5=8A=
=9F
            countDownLatch.await(10, TimeUnit.SECONDS);
            if (zk =3D=3D null) {
                throw new NullPointerException("zooKeeper connect failure")=
;
            }
            Stat stat =3D zk.exists(root, true);
            if (stat =3D=3D null) {
                //=E5=88=9B=E5=BB=BA=E6=8C=81=E4=B9=85=E5=8C=96=E6=A0=B9=E8=
=8A=82=E7=82=B9
                zk.create(root, new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, C=
reateMode.PERSISTENT);
                logger.info("=E6=A0=B9=E8=8A=82=E7=82=B9{}=E5=88=9B=E5=BB=
=BA=E5=AE=8C=E6=88=90", root);
            } else {
                logger.info("=E6=A0=B9=E8=8A=82=E7=82=B9{}=E5=B7=B2=E5=AD=
=98=E5=9C=A8=EF=BC=8C=E7=9B=B4=E6=8E=A5=E4=BD=BF=E7=94=A8", root);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    /**
     * =E7=9B=91=E5=90=ACzk=E6=98=AF=E5=90=A6=E9=9C=80=E8=A6=81=E9=87=8D=E8=
=BF=9E=E6=8E=A5
     * @param watchedEvent
     */
    @Override
    public void process(WatchedEvent watchedEvent) {
        try {
            //zk=E7=9A=84session=E8=BF=87=E6=9C=9F=E6=97=B6=EF=BC=8C=E9=87=
=8D=E6=96=B0=E5=88=9B=E5=BB=BA=E8=BF=9E=E6=8E=A5
            if (watchedEvent.getState() =3D=3D Event.KeeperState.Expired) {
                logger.info("zk=E8=BF=9E=E6=8E=A5=E8=BF=87=E6=9C=9F=EF=BC=
=8C=E9=87=8D=E6=96=B0=E5=88=9B=E5=BB=BA=E8=BF=9E=E6=8E=A5");
                zk.close();
                zk =3D null;
                createRootNode();
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    /**
     * =E5=88=9B=E5=BB=BA=E5=85=B7=E4=BD=93=E7=9A=84=E9=94=81=E8=8A=82=E7=
=82=B9
     *
     * @param lockPath
     */
    private void createLockNode(String lockPath) {
        try {
            //=E5=88=A4=E6=96=AD=E6=8C=87=E5=AE=9A=E9=94=81=E8=B7=AF=E5=BE=
=84=E6=98=AF=E5=90=A6=E5=AD=98=E5=9C=A8=EF=BC=8C=E8=8B=A5=E4=B8=8D=E5=AD=98=
=E5=9C=A8=E5=88=99=E5=88=9B=E5=BB=BA
            Stat stat =3D zk.exists(lockPath, true);
            if (stat =3D=3D null) {
                //=E5=88=9B=E5=BB=BA=E6=8C=81=E4=B9=85=E5=8C=96=E9=94=81=E8=
=8A=82=E7=82=B9
                zk.create(lockPath, new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAF=
E, CreateMode.PERSISTENT);
                logger.info("=E9=94=81=E8=B7=AF=E5=BE=84=E5=88=9B=E5=BB=BA=
=E6=88=90=E5=8A=9F=EF=BC=9A{}", lockPath);
            } else {
                logger.info("=E9=94=81=E8=B7=AF=E5=BE=84=E5=B7=B2=E7=BB=8F=
=E5=AD=98=E5=9C=A8=EF=BC=9A{}", lockPath);
            }
        } catch (KeeperException.NodeExistsException e) {
            logger.error("node=E8=8A=82=E7=82=B9=E5=B7=B2=E7=BB=8F=E5=AD=98=
=E5=9C=A8=EF=BC=8C=E6=9C=AC=E6=AC=A1=E5=88=9B=E5=BB=BA=E5=A4=B1=E8=B4=A5=EF=
=BC=9A{}", e.getMessage());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    /**
     * =E9=98=BB=E5=A1=9E=E9=94=81
     * @param lockName =E9=94=81=E5=90=8D
     */
    public void lock(String lockName) {
        try {
            //=E5=88=9B=E5=BB=BA=E9=94=81=E7=9B=AE=E5=BD=95
            String lockPath =3D root + "/" + lockName;
            createLockNode(lockPath);

            //=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=E5=BB=BA=E7=9A=
=84=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=82=B9
            String clientLockNode =3D zk.create(lockPath + "/client", new b=
yte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);

            //=E8=8E=B7=E5=8F=96=E5=BD=93=E5=89=8D=E4=B8=B4=E6=97=B6=E9=A1=
=BA=E5=BA=8F=E8=8A=82=E7=82=B9=E7=9A=84=E5=89=8D=E4=B8=80=E4=B8=AA=E8=8A=82=
=E7=82=B9=EF=BC=8C=E8=8B=A5=E8=8E=B7=E5=8F=96=E7=9A=84=E5=89=8D=E7=BD=AE=E8=
=8A=82=E7=82=B9=E4=B8=BAnull=EF=BC=8C=E5=88=99=E8=A1=A8=E7=A4=BA=E5=BD=93=
=E5=89=8D=E8=8A=82=E7=82=B9=E8=8E=B7=E5=8F=96=E5=88=B0=E9=94=81
            String preNode=3DgetPreNode(lockPath,clientLockNode);
            CountDownLatch latch =3D new CountDownLatch(1);
            if(preNode!=3Dnull){
                //=E6=B3=A8=E5=86=8C=E7=9B=91=E5=90=AC
                Stat lockStat =3D zk.exists(preNode, new LockWatcher(latch,=
lockPath,clientLockNode));
                if (lockStat !=3D null) {
                    // =E7=AD=89=E5=BE=85
                    latch.await();
                    latch =3D null;
                    addLock(clientLockNode);
                    logger.info("=E9=98=BB=E5=A1=9E=E7=BA=BF=E7=A8=8B=E9=94=
=81=E8=8E=B7=E5=8F=96=E6=88=90=E5=8A=9F=EF=BC=8C=E9=94=81=E8=B7=AF=E5=BE=84=
=E4=B8=BA=EF=BC=9A{}", clientLockNode);
                }
            }
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    /**
     * =E8=8E=B7=E5=8F=96=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=E5=
=BB=BA=E7=9A=84=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=82=B9=E7=9A=
=84=E5=89=8D=E4=B8=80=E4=B8=AA=E8=8A=82=E7=82=B9
     * @param lockPath =E9=94=81=E8=B7=AF=E5=BE=84
     * @param clientLockNode =E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=
=E5=BB=BA=E7=9A=84=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=82=B9
     * @return =E5=89=8D=E4=B8=80=E4=B8=AA=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=
=8F=E8=8A=82=E7=82=B9
     */
    private String getPreNode(String lockPath,String clientLockNode){
        String preNode=3Dnull;
        try {
            // =E5=8F=96=E5=87=BAlockPath=E4=B8=8B=E6=89=80=E6=9C=89=E5=AD=
=90=E8=8A=82=E7=82=B9
            List&lt;String&gt; subNodes =3D zk.getChildren(lockPath, true);
            TreeSet&lt;String&gt; sortedNodes =3D new TreeSet&lt;&gt;();
            for (String node : subNodes) {
                sortedNodes.add(lockPath + "/" + node);
            }
            //=E8=8E=B7=E5=8F=96=E6=9C=80=E5=B0=8F=E4=B8=B4=E6=97=B6=E9=A1=
=BA=E5=BA=8F=E8=8A=82=E7=82=B9
            String minNode =3D sortedNodes.first();
            // =E5=A6=82=E6=9E=9C=E5=BD=93=E5=89=8D=E8=8A=82=E7=82=B9=E6=98=
=AF=E6=9C=80=E5=B0=8F=E8=8A=82=E7=82=B9,=E5=88=99=E8=A1=A8=E7=A4=BA=E5=8F=
=96=E5=BE=97=E9=94=81
            if (clientLockNode.equals(minNode)) {
                addLock(clientLockNode);
                logger.info("=E9=94=81=E8=8E=B7=E5=8F=96=E6=88=90=E5=8A=9F=
=EF=BC=8C=E9=94=81=E8=B7=AF=E5=BE=84=E4=B8=BA=EF=BC=9A{}", clientLockNode);
            }else{
                //=E8=8E=B7=E5=8F=96=E6=AF=94=E5=BD=93=E5=89=8D=E8=8A=82=E7=
=82=B9=E5=B0=8F=E7=9A=84=E6=9C=80=E5=A4=A7=E8=8A=82=E7=82=B9=E8=BF=9B=E8=A1=
=8C=E7=9B=91=E5=90=AC
                preNode =3D sortedNodes.lower(clientLockNode);
                logger.info("=E9=98=BB=E5=A1=9E=E7=AD=89=E5=BE=85=E8=8E=B7=
=E5=8F=96=E9=94=81=EF=BC=8C=E9=94=81=E8=B7=AF=E5=BE=84=E4=B8=BA=EF=BC=9A{}=
=EF=BC=8C=E7=9B=91=E5=90=AC=E7=9A=84=E5=89=8D=E7=BD=AE=E8=8A=82=E7=82=B9=E4=
=B8=BA=EF=BC=9A{}", clientLockNode, preNode);
            }
        }catch (Exception e){

        }
        return preNode;
    }

    /**
     * =E7=9B=91=E5=90=AC=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=
=82=B9=E6=98=AF=E5=90=A6=E8=A2=AB=E5=88=A0=E9=99=A4
     */
    class LockWatcher implements Watcher {
        private CountDownLatch latch =3D null;
        private String lockPath =3D null;
        private String clientLockNode =3D null;
        public LockWatcher(CountDownLatch latch,String lockPath,String clie=
ntLockNode) {
            this.latch =3D latch;
            this.lockPath=3DlockPath;
            this.clientLockNode=3DclientLockNode;
        }
        @Override
        public void process(WatchedEvent event) {
            if (event.getType() =3D=3D Event.EventType.NodeDeleted) {
                //=E8=8B=A5=E5=BD=93=E5=89=8D=E8=8A=82=E7=82=B9=E7=9A=84=E5=
=89=8D=E7=BD=AE=E8=8A=82=E7=82=B9=E8=A2=AB=E5=88=A0=E9=99=A4=EF=BC=8C=E9=9C=
=80=E9=87=8D=E6=96=B0=E5=88=A4=E6=96=AD=E5=BD=93=E5=89=8D=E8=8A=82=E7=82=B9=
=E6=98=AF=E5=90=A6=E8=BF=98=E5=AD=98=E5=9C=A8=E5=89=8D=E7=BD=AE=E8=8A=82=E7=
=82=B9
                //=E6=AD=A3=E5=B8=B8=E6=83=85=E5=86=B5=E4=B8=8B=E5=89=8D=E7=
=BD=AE=E8=8A=82=E7=82=B9=E5=88=A0=E9=99=A4=EF=BC=8C=E5=88=99=E8=A1=A8=E7=A4=
=BA=E5=BD=93=E5=89=8D=E8=8A=82=E7=82=B9=E8=8E=B7=E5=8F=96=E9=94=81
                //=E5=BD=93=E5=89=8D=E7=BD=AE=E8=8A=82=E7=82=B9=E6=B2=A1=E6=
=9C=89=E8=8E=B7=E5=8F=96=E9=94=81=EF=BC=8C=E4=BD=86=E6=98=AF=E5=BC=82=E5=B8=
=B8=E6=96=AD=E8=BF=9E=E6=97=B6=EF=BC=8C=E5=BD=93=E5=89=8D=E8=8A=82=E7=82=B9=
=E5=88=99=E9=9C=80=E7=9B=91=E5=90=AC=E5=89=A9=E4=BD=99=E7=9A=84=E6=9C=80=E5=
=A4=A7=E5=89=8D=E7=BD=AE=E8=8A=82=E7=82=B9
                String preNode=3DgetPreNode(lockPath,clientLockNode);
                if(preNode=3D=3Dnull){
                    latch.countDown();
                }else{
                    try {
                        zk.exists(preNode, new LockWatcher(latch,lockPath,c=
lientLockNode));
                    }catch (Exception e){

                    }
                }
            }
        }
    }

    /**
     * =E5=B0=9D=E8=AF=95=E8=8E=B7=E5=8F=96=E9=94=81
     * @param lockName
     * @return
     */
    public boolean tryLock(String lockName) {
        try {
            //=E5=88=9B=E5=BB=BA=E9=94=81=E7=9B=AE=E5=BD=95
            String lockPath =3D root + "/" + lockName;
            createLockNode(lockPath);
            //=E5=BD=93=E5=89=8D=E7=BA=BF=E7=A8=8B=E5=88=9B=E5=BB=BA=E7=9A=
=84=E4=B8=B4=E6=97=B6=E9=A1=BA=E5=BA=8F=E8=8A=82=E7=82=B9
            String clientLockNode =3D zk.create(lockPath + "/client", new b=
yte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);
            String preNode =3D getPreNode(lockPath, clientLockNode);
            // =E5=A6=82=E6=9E=9C=E5=BD=93=E5=89=8D=E8=8A=82=E7=82=B9=E6=98=
=AF=E6=9C=80=E5=B0=8F=E8=8A=82=E7=82=B9,=E5=88=99=E8=A1=A8=E7=A4=BA=E5=8F=
=96=E5=BE=97=E9=94=81
            addLock(clientLockNode);
            if (preNode =3D=3D null) {
                logger.info("=E9=94=81=E8=8E=B7=E5=8F=96=E6=88=90=E5=8A=9F=
=EF=BC=8C=E9=94=81=E8=B7=AF=E5=BE=84=E4=B8=BA=EF=BC=9A{}", clientLockNode);
                return true;
            }else{
=09=09=09=09unlock(lockName);
=09=09=09}
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
        return false;
    }

    /**
     * =E5=AD=98=E5=82=A8=E6=9C=AC=E6=AC=A1=E7=BA=BF=E7=A8=8B=E4=B8=AD=E6=
=B7=BB=E5=8A=A0=E7=9A=84=E9=94=81
     * @param lockPath
     */
    private void addLock(String lockPath) {
        List&lt;String&gt; list =3D nodePathList.get();
        if (list =3D=3D null) {
            list =3D new ArrayList&lt;&gt;();
        }
        list.add(lockPath);
        nodePathList.set(list);
    }

    /**
     * =E5=88=A0=E9=99=A4=E9=94=81
     */
    public void unlock(String lockName) {
        try {
            String lockPathPrefix =3D root + "/" + lockName;
            String lockPath =3D "";
            List&lt;String&gt; list =3D nodePathList.get();
            if (list !=3D null &amp;&amp; list.size() &gt; 0) {
                Iterator&lt;String&gt; iterator =3D list.iterator();
                while (iterator.hasNext()) {
                    String lockWholePath =3D iterator.next();
                    if (lockWholePath.contains(lockPathPrefix)) {
                        lockPath =3D lockWholePath;
                        iterator.remove();
                        break;
                    }
                }
                if (StringUtils.isNotBlank(lockPath)) {
                    Stat stat =3D zk.exists(lockPath, true);
                    if (stat !=3D null) {
                        zk.delete(lockPath, -1);
                        logger.info("=E9=94=81=E9=87=8A=E6=94=BE=E6=88=90=
=E5=8A=9F=EF=BC=8C=E9=94=81=E8=B7=AF=E5=BE=84=E4=B8=BA=EF=BC=9A{}", lockPat=
h);
                    }
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}


</pre>=20
</div>=20
</div>
<p><strong>2</strong><strong>=EF=BC=89=E4=BC=98=E7=82=B9</strong></p>
<ul>
<li>=E6=80=A7=E8=83=BD=E8=BE=83=E5=A5=BD=EF=BC=8C=E5=8F=AF=E7=94=A8=E6=80=
=A7=E9=AB=98=EF=BC=8C=E5=8F=AF=E4=BB=A5=E5=BE=88=E6=96=B9=E4=BE=BF=E7=9A=84=
=E5=AE=9E=E7=8E=B0=E9=98=BB=E5=A1=9E=E9=94=81=EF=BC=9B</li>
<li>=E5=AE=A2=E6=88=B7=E7=AB=AF=E5=AE=95=E6=9C=BA=E7=AD=89=E5=BC=82=E5=B8=
=B8=E6=83=85=E5=86=B5=E4=B8=8B=EF=BC=8C=E5=BD=93=E5=89=8D=E5=AE=A2=E6=88=B7=
=E7=AB=AF=E6=8C=81=E6=9C=89=E7=9A=84=E9=94=81=E5=8F=AF=E5=AE=9E=E6=97=B6=E9=
=87=8A=E6=94=BE=EF=BC=9B</li>
<li>=E4=BE=9D=E6=8D=AEZookeeper=E5=AE=98=E6=96=B9API=E8=87=AA=E5=AE=9A=E4=
=B9=89=E5=AE=9E=E7=8E=B0=EF=BC=8C=E6=9C=89=E9=97=AE=E9=A2=98=E6=96=B9=E4=BE=
=BF=E6=8E=92=E6=9F=A5=EF=BC=9B</li>
</ul>
<p><strong>3=EF=BC=89=E7=BC=BA=E7=82=B9</strong></p>
<ul>
<li>Zookeeper API=E6=8A=9B=E5=87=BA=E7=9A=84=E5=90=84=E7=A7=8D=E5=BC=82=E5=
=B8=B8=E9=9C=80=E6=89=8B=E5=8A=A8=E5=A4=84=E7=90=86=EF=BC=9B&nbsp;</li>
<li>ZK=E8=BF=9E=E6=8E=A5=E7=AE=A1=E7=90=86=EF=BC=8Csession=E5=A4=B1=E6=95=
=88=E7=AE=A1=E7=90=86=E9=9C=80=E6=89=8B=E5=8A=A8=E5=A4=84=E7=90=86=EF=BC=9B=
</li>
<li>Watch=E5=8F=AA=E7=94=9F=E6=95=88=E4=B8=80=E6=AC=A1=EF=BC=8C=E9=9C=80=E5=
=8F=8D=E5=A4=8D=E9=87=8D=E8=BF=9E=EF=BC=9B</li>
<li>=E4=B8=8D=E9=80=82=E7=94=A8=E5=9C=BA=E6=99=AF=EF=BC=9A=E4=B8=80=E4=B8=
=AA=E7=BA=BF=E7=A8=8B=E4=B8=AD=E5=85=88=E6=B7=BB=E5=8A=A0A=E9=94=81=E5=86=
=8D=E6=B7=BB=E5=8A=A0B=E9=94=81=EF=BC=8C=E5=90=8C=E6=97=B6=E5=8F=A6=E4=B8=
=80=E4=B8=AA=E7=BA=BF=E7=A8=8B=E5=85=88=E6=B7=BB=E5=8A=A0B=E9=94=81=E5=86=
=8D=E6=B7=BB=E5=8A=A0A=E9=94=81=EF=BC=8C=E8=AF=A5=E7=A7=8D=E6=AD=BB=E9=94=
=81=E9=97=AE=E9=A2=98=E6=97=A0=E6=B3=95=E8=A7=A3=E5=86=B3=EF=BC=9B</li>
</ul>
<h3 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-2.2.ApacheCurator=E5=AE=9E=E7=8E=B0">2.2. Apache Curator=E5=AE=
=9E=E7=8E=B0</h3>
<p><strong>1=EF=BC=89=E5=AE=9E=E7=8E=B0=E6=80=9D=E8=B7=AF</strong></p>
<p>Curator=E6=98=AFNetflix=E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=90=E7=9A=84=E4=
=B8=80=E5=A5=97ZK=E5=AE=A2=E6=88=B7=E7=AB=AF=E6=A1=86=E6=9E=B6=EF=BC=8C=E9=
=81=B5=E5=BE=AAApache2.0=E5=BC=80=E6=BA=90=E5=8D=8F=E8=AE=AE=EF=BC=8CCurato=
r=E4=B8=AD=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E7=9A=84=E5=AE=9E=E7=8E=B0=
=E6=80=9D=E8=B7=AF=E4=B8=8E=E9=80=9A=E8=BF=87ZK=E5=AE=98=E6=96=B9API=E8=87=
=AA=E5=AE=9A=E4=B9=89=E5=AE=9E=E7=8E=B0=E5=9F=BA=E6=9C=AC=E4=B8=80=E8=87=B4=
=EF=BC=8C=E4=BB=A5=E4=B8=8B=E4=B8=BAAPI=E8=B0=83=E7=94=A8Demo</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">=E8=B0=83=E7=94=A8Demo</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">import org.apache.curator.framework.CuratorFramework;
import org.apache.curator.framework.CuratorFrameworkFactory;
import org.apache.curator.framework.recipes.locks.InterProcessMutex;
import org.apache.curator.retry.RetryNTimes;

/**
 * &lt;dependency&gt;
 *     &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
 *     &lt;artifactId&gt;apache-curator&lt;/artifactId&gt;
 *     &lt;version&gt;4.1.0&lt;/version&gt;
 *     &lt;type&gt;pom&lt;/type&gt;
 * &lt;/dependency&gt;
 */
public class CuratorLockDemo {
    static String zkAddress =3D "192.168.108.28:2181";
    static String root =3D "/locksNode";
    static volatile CuratorFramework client;
    private static void getInstance() {
        if (client =3D=3D null) {
            synchronized (CuratorLockDemo.class) {
                if (client =3D=3D null) {
                    //=E9=87=8D=E8=AF=95=E7=AD=96=E7=95=A5=EF=BC=9A=E9=97=
=B4=E9=9A=94=E6=97=B6=E9=97=B4=E4=B8=BA1s=EF=BC=8C=E9=87=8D=E8=AF=9510=E6=
=AC=A1
                    client =3D CuratorFrameworkFactory.newClient(zkAddress,=
 new RetryNTimes(10, 1000));
                    //=E5=BC=80=E5=90=AF=E8=BF=9E=E6=8E=A5
                    client.start();
                }
            }
        }
    }

    public static InterProcessMutex getLockClass(String lockName) {
        getInstance();
        InterProcessMutex lock =3D new InterProcessMutex(client, root + "/"=
 + lockName);
        return lock;
    }

    //=E6=B5=8B=E8=AF=95=E8=B0=83=E7=94=A8
    public static void main(String[] args) {
        new Thread(new Runnable() {
            @Override
            public void run() {
                try {
                    InterProcessMutex lock =3D getLockClass("test4");
                    lock.acquire();
                    System.out.println(Thread.currentThread().getName() + "=
=E8=8E=B7=E5=8F=96=E4=BA=86test4=E9=94=81");
                    Thread.sleep(5000);
                    lock.release();
                    System.out.println(Thread.currentThread().getName() + "=
=E9=87=8A=E6=94=BE=E4=BA=86test4=E9=94=81");
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }, "t").start();
    }
}</pre>=20
</div>=20
</div>
<p><strong>2</strong><strong>=EF=BC=89=E4=BC=98=E7=82=B9</strong></p>
<ul>
<li>Curator=E5=B0=81=E8=A3=85=E8=BE=83=E4=B8=BA=E5=BD=BB=E5=BA=95=EF=BC=8CA=
PI=E7=AE=80=E5=8D=95=E6=98=8E=E4=BA=86=EF=BC=8C=E6=8E=8C=E6=8F=A1=E5=8F=8A=
=E6=8E=A5=E5=85=A5=E6=88=90=E6=9C=AC=E5=BE=88=E4=BD=8E=EF=BC=8C</li>
<li>=E5=AE=A2=E6=88=B7=E7=AB=AF=E5=AE=95=E6=9C=BA=E7=AD=89=E5=BC=82=E5=B8=
=B8=E6=83=85=E5=86=B5=E4=B8=8B=EF=BC=8C=E5=BD=93=E5=89=8D=E5=AE=A2=E6=88=B7=
=E7=AB=AF=E6=8C=81=E6=9C=89=E7=9A=84=E9=94=81=E5=8F=AF=E5=AE=9E=E6=97=B6=E9=
=87=8A=E6=94=BE=EF=BC=9B</li>
<li>=E8=A7=A3=E5=86=B3=E4=BA=86=E5=90=84=E7=A7=8D=E5=BC=82=E5=B8=B8=E5=A4=
=84=E7=90=86=E3=80=81Watch=E5=8F=8D=E5=A4=8D=E6=B3=A8=E5=86=8C=E7=9A=84=E9=
=97=AE=E9=A2=98=EF=BC=9B</li>
<li>=E6=8F=90=E4=BE=9B=E4=BA=86=E5=90=84=E7=A7=8D=E5=88=86=E5=B8=83=E5=BC=
=8F=E5=9C=BA=E6=99=AF=E4=B8=8B=E7=9A=84=E5=B7=A5=E5=85=B7=E5=8C=85=EF=BC=8C=
=E4=BE=8B=E5=A6=82=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E7=9A=84=E5=AE=9E=E7=
=8E=B0=EF=BC=8C=E5=88=86=E5=B8=83=E5=BC=8FCyclicBarrier=E5=AE=9E=E7=8E=B0=
=E3=80=81Leader=E9=80=89=E4=B8=BE=E7=AD=89=EF=BC=9B</li>
</ul>
<p><strong>3=EF=BC=89=E7=BC=BA=E7=82=B9</strong></p>
<ul>
<li><p>=E4=B8=8D=E9=80=82=E7=94=A8=E5=9C=BA=E6=99=AF=EF=BC=9A=E4=B8=80=E4=
=B8=AA=E7=BA=BF=E7=A8=8B=E4=B8=AD=E5=85=88=E6=B7=BB=E5=8A=A0A=E9=94=81=E5=
=86=8D=E6=B7=BB=E5=8A=A0B=E9=94=81=EF=BC=8C=E5=90=8C=E6=97=B6=E5=8F=A6=E4=
=B8=80=E4=B8=AA=E7=BA=BF=E7=A8=8B=E5=85=88=E6=B7=BB=E5=8A=A0B=E9=94=81=E5=
=86=8D=E6=B7=BB=E5=8A=A0A=E9=94=81=EF=BC=8C=E8=AF=A5=E7=A7=8D=E6=AD=BB=E9=
=94=81=E9=97=AE=E9=A2=98=E6=97=A0=E6=B3=95=E8=A7=A3=E5=86=B3=EF=BC=9B</p></=
li>
</ul>
<h3 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-2.3.=E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=90=E7=9A=84SharkLock=E5=
=AE=9E=E7=8E=B0">2.3. =E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=90=E7=9A=84SharkLoc=
k=E5=AE=9E=E7=8E=B0</h3>
<p><strong>1=EF=BC=89=E4=BB=8B=E7=BB=8D</strong></p>
<p>=E9=94=81=E5=AE=9E=E7=8E=B0=E4=BB=8B=E7=BB=8D=EF=BC=9A<a href=3D"http://=
jpcloud.jd.com/pages/viewpage.action?pageId=3D22587661" class=3D"external-l=
ink" rel=3D"nofollow">http://jpcloud.jd.com/pages/viewpage.action?pageId=3D=
22587661</a></p>
<p>=E9=94=81=E4=BD=BF=E7=94=A8demo=EF=BC=9A<a href=3D"http://jpcloud.jd.com=
/pages/viewpage.action?pageId=3D22586768" class=3D"external-link" rel=3D"no=
follow">http://jpcloud.jd.com/pages/viewpage.action?pageId=3D22586768</a></=
p>
<p>=E9=94=81=E6=8E=A5=E5=85=A5=E6=93=8D=E4=BD=9C=E4=BB=8B=E7=BB=8D=EF=BC=9A=
<a href=3D"http://jpcloud.jd.com/pages/viewpage.action?pageId=3D22586799" c=
lass=3D"external-link" rel=3D"nofollow">http://jpcloud.jd.com/pages/viewpag=
e.action?pageId=3D22586799</a></p>
<p><strong>2=EF=BC=89=E4=BC=98=E7=82=B9</strong></p>
<ul>
<li>API=E5=B0=81=E8=A3=85=E5=BD=BB=E5=BA=95=EF=BC=8C=E6=8E=A5=E5=85=A5=E7=
=AE=80=E5=8D=95=EF=BC=9B</li>
<li>=E8=A7=A3=E5=86=B3=E4=BA=86=E6=AD=BB=E9=94=81=E9=97=AE=E9=A2=98=EF=BC=
=9A=E4=B8=80=E4=B8=AA=E7=BA=BF=E7=A8=8B=E4=B8=AD=E5=85=88=E6=B7=BB=E5=8A=A0=
A=E9=94=81=E5=86=8D=E6=B7=BB=E5=8A=A0B=E9=94=81=EF=BC=8C=E5=90=8C=E6=97=B6=
=E5=8F=A6=E4=B8=80=E4=B8=AA=E7=BA=BF=E7=A8=8B=E5=85=88=E6=B7=BB=E5=8A=A0B=
=E9=94=81=E5=86=8D=E6=B7=BB=E5=8A=A0A=E9=94=81=E3=80=90=E8=A7=A3=E5=86=B3=
=E6=96=B9=E6=A1=88=EF=BC=9A=E4=B8=80=E4=B8=AA=E7=BA=BF=E7=A8=8B=E6=8A=A5=E9=
=94=99=E5=81=9C=E6=AD=A2=EF=BC=8C=E5=8F=A6=E4=B8=80=E4=B8=AA=E7=BA=BF=E7=A8=
=8B=E7=BB=A7=E7=BB=AD=E5=90=91=E4=B8=8B=E6=89=A7=E8=A1=8C=E3=80=91=EF=BC=9B=
</li>
<li>=E6=8F=90=E4=BE=9B=E4=BA=86=E4=B8=80=E4=B8=AA=E7=AC=AC=E4=B8=89=E6=96=
=B9=E7=AE=A1=E7=90=86=E7=95=8C=E9=9D=A2=EF=BC=8C=E5=8F=AF=E6=9F=A5=E7=9C=8B=
=E9=94=81=E8=BF=87=E6=9C=9F=E6=97=B6=E9=97=B4=E7=AD=89=E4=BF=A1=E6=81=AF=EF=
=BC=9B</li>
</ul>
<p><strong>3=EF=BC=89=E7=BC=BA=E7=82=B9</strong></p>
<ul>
<li>=E8=AF=A5=E6=A1=86=E6=9E=B6=E4=B8=BA=E5=85=AC=E5=8F=B8=E5=BC=80=E6=BA=
=90=E7=9A=84=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=EF=BC=8C=E4=BD=86=E7=9B=AE=
=E5=89=8D=E5=8F=82=E8=80=83=E6=96=87=E6=A1=A3=E5=8F=AA=E9=99=90=E4=BA=8Ecf=
=E6=96=87=E6=A1=A3=EF=BC=8C=E7=BD=91=E4=B8=8A=E6=97=A0=E8=B5=84=E6=96=99=EF=
=BC=8C=E4=B8=94cf=E6=96=87=E6=A1=A3=E4=BB=8B=E7=BB=8D=E8=BE=83=E4=B8=BA=E7=
=AE=80=E5=8D=95=EF=BC=8C=E4=B8=80=E4=BA=9B=E4=BB=8B=E7=BB=8D=E4=B8=AD=E5=AD=
=98=E5=9C=A8=E7=9A=84=E7=89=B9=E6=80=A7=E6=97=A0=E5=AF=B9=E5=BA=94demo=EF=
=BC=9B</li>
<li>=E6=8E=A5=E5=85=A5=E5=8F=AA=E6=8F=90=E4=BE=9B=E4=BA=86=E7=AE=80=E5=8D=
=95=E7=9A=84=E5=AE=A2=E6=88=B7=E7=AB=AF=E8=BF=9E=E6=8E=A5=E7=A8=8B=E5=BA=8F=
=EF=BC=8C=E8=8B=A5=E5=87=BA=E7=8E=B0=E9=97=AE=E9=A2=98=EF=BC=8C=E6=97=A0=E6=
=B3=95=E6=8E=92=E6=9F=A5=EF=BC=8C=E5=8F=AA=E8=83=BD=E4=BE=9D=E8=B5=96=E5=AF=
=B9=E6=96=B9=EF=BC=9B</li>
<li>=E6=B2=9F=E9=80=9A=E8=BF=87=E7=A8=8B=E4=B8=AD=E5=AF=B9=E6=96=B9=E5=9B=
=9E=E5=A4=8D=E6=B6=88=E6=81=AF=E6=85=A2=EF=BC=8C=E6=B2=9F=E9=80=9A=E5=AD=98=
=E5=9C=A8=E4=B8=80=E5=AE=9A=E9=97=AE=E9=A2=98=EF=BC=8C=E5=87=BA=E7=8E=B0=E9=
=97=AE=E9=A2=98=E6=97=A0=E6=B3=95=E4=BF=9D=E9=9A=9C=E5=AF=B9=E6=96=B9=E5=8F=
=8A=E6=97=B6=E5=93=8D=E5=BA=94=EF=BC=9B</li>
</ul>
<h2 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-3.=E8=B0=83=E7=A0=94=E7=BB=93=E8=AE=BA"><strong>3.=E8=B0=83=E7=
=A0=94=E7=BB=93=E8=AE=BA</strong></h2>
<ul>
<li>Redis=EF=BC=9A=E5=AE=9E=E7=8E=B0=E7=AE=80=E5=8D=95=EF=BC=8C=E4=BD=86=E5=
=AF=B9=E4=BA=8E=E8=80=97=E6=97=B6=E9=95=BF=E7=9A=84=E4=BB=BB=E5=8A=A1=E5=8A=
=A0=E9=94=81=E5=AD=98=E5=9C=A8=E7=BC=BA=E9=99=B7=EF=BC=8C=E4=B8=94=E8=87=AA=
=E8=BA=AB=E7=89=B9=E6=80=A7=E4=B8=8D=E6=94=AF=E6=8C=81=E9=98=BB=E5=A1=9E=E9=
=94=81=EF=BC=9B</li>
<li>ZK=E5=AE=98=E6=96=B9API=EF=BC=9A=E5=8A=9F=E8=83=BD=E5=8F=AF=E7=94=A8=EF=
=BC=8C=E4=BD=86=E6=9C=89=E5=8F=AF=E8=83=BD=E4=B8=80=E4=BA=9B=E8=BE=B9=E7=95=
=8C=E9=97=AE=E9=A2=98=E7=9A=84=E5=A4=84=E7=90=86=E8=BF=87=E4=BA=8E=E7=B2=97=
=E7=B3=99=EF=BC=9B</li>
<li>Curator=EF=BC=9A=E6=BB=A1=E8=B6=B3=E4=B8=9A=E5=8A=A1=E5=9C=BA=E6=99=AF(=
=E8=99=BD=E7=84=B6=E6=9C=89A=E3=80=81B=E8=B5=84=E6=BA=90=E4=BA=A4=E5=8F=89=
=E5=8A=A0=E9=94=81=E5=AF=BC=E8=87=B4=E7=9A=84=E6=AD=BB=E9=94=81=E9=97=AE=E9=
=A2=98=E4=B8=8D=E8=83=BD=E8=A7=A3=E5=86=B3=EF=BC=8C=E4=BD=86=E7=9B=AE=E5=89=
=8D=E6=B2=A1=E5=8F=91=E7=8E=B0=E5=AD=98=E5=9C=A8=E6=AD=A4=E7=B1=BB=E4=B8=9A=
=E5=8A=A1=E5=9C=BA=E6=99=AF)=EF=BC=8C=E4=B8=94=E5=8F=82=E8=80=83=E8=B5=84=
=E6=96=99=E5=A4=9A=EF=BC=8C=E4=B8=8D=E7=94=A8=E8=BF=87=E5=88=86=E4=BE=9D=E8=
=B5=96=E4=BB=96=E4=BA=BA=EF=BC=8C=E6=9C=89=E5=88=A9=E4=BA=8E=E4=BB=A5=E5=90=
=8E=E6=8E=92=E6=9F=A5=E9=97=AE=E9=A2=98=EF=BC=9B</li>
<li>ShakLock=EF=BC=9A=E6=BB=A1=E8=B6=B3=E4=B8=9A=E5=8A=A1=E5=9C=BA=E6=99=AF=
=EF=BC=8C=E5=BC=82=E5=B8=B8=E6=83=85=E5=86=B5=E4=B8=8B=E9=94=81=E5=AE=9E=E6=
=97=B6=E9=87=8A=E6=94=BE=EF=BC=8C=E8=A7=A3=E5=86=B3=E4=BA=86=E6=AD=BB=E9=94=
=81=E9=97=AE=E9=A2=98=EF=BC=8C=E4=BD=86=E6=98=AF=E5=9B=A0=E4=B8=BA=E6=B2=9F=
=E9=80=9A=E5=8F=8A=E6=94=AF=E6=8C=81=E4=B8=8A=E5=AF=B9=E6=96=B9=E6=B2=A1=E6=
=9C=89=E6=98=8E=E7=A1=AE=E7=AD=94=E5=A4=8D=EF=BC=8C=E5=8F=AF=E8=83=BD=E5=AD=
=98=E5=9C=A8=E6=BD=9C=E5=9C=A8=E9=9A=90=E6=82=A3=EF=BC=9B</li>
</ul>
<p>=E7=BB=93=E5=90=88=E4=B8=9A=E5=8A=A1=E5=9C=BA=E6=99=AF=E9=9C=80=E8=A6=81=
=E5=8F=8A=E5=8F=AF=E8=83=BD=E5=AD=98=E5=9C=A8=E7=9A=84=E9=97=AE=E9=A2=98=E6=
=8E=92=E6=9F=A5=EF=BC=8C=E5=86=B3=E5=AE=9A=E5=B0=86Apache Curator=E6=8E=A5=
=E5=85=A5=E9=A1=B9=E7=9B=AE=EF=BC=9B</p>
<p><br></p>
<h2 id=3D"id-=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E9=80=89=E5=9E=8B=E8=B0=
=83=E7=A0=94-4.Curator=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E6=8E=A5=E5=85=
=A5=E9=A1=B9=E7=9B=AE"><strong>4.Curator=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=
=81=E6=8E=A5=E5=85=A5=E9=A1=B9=E7=9B=AE</strong></h2>
<p><br></p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">Maven=E4=BE=9D=E8=B5=96</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
    &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;
    &lt;version&gt;4.1.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
    &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;
    &lt;version&gt;4.1.0&lt;/version&gt;
&lt;/dependency&gt;</pre>=20
</div>=20
</div>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">=E5=AF=B9=E5=A4=96=E6=8E=A5=E5=8F=A3</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">import java.util.concurrent.TimeUnit;

/**
 * =E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81
 * @author
 */
public interface DistributedLock {
    /**
     * =E8=8E=B7=E5=8F=96=E9=94=81(=E9=98=BB=E5=A1=9E)
     * @param lockName =E9=94=81=E5=90=8D
     */
    void lock(String lockName);
    /**
     * =E8=8E=B7=E5=8F=96=E9=94=81(=E7=9B=B4=E6=8E=A5=E8=BF=94=E5=9B=9E)
     * @param lockName =E9=94=81=E5=90=8D
     * @return
     */
    boolean tryLock(String lockName);
    /**
     * =E8=8E=B7=E5=8F=96=E9=94=81(=E7=9B=B4=E6=8E=A5=E8=BF=94=E5=9B=9E)
     * @param lockName =E9=94=81=E5=90=8D
     * @param time     =E8=B6=85=E6=97=B6=E6=97=B6=E9=97=B4
     * @param unit     =E8=B6=85=E6=97=B6=E5=8D=95=E4=BD=8D
     * @return
     */
    boolean tryLock(String lockName, long time, TimeUnit unit);
    /**
     * =E9=87=8A=E6=94=BE=E9=94=81
     * @param lockName =E9=94=81=E5=90=8D
     */
    void unLock(String lockName);
}</pre>=20
</div>=20
</div>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">Curator=E5=88=86=E5=B8=83=E5=BC=8F=E9=94=81=E5=AE=
=9E=E7=8E=B0</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">import com.jd.trip.hotel.platform.common.utils.PropertiesUtil;
import com.jd.trip.hotel.resource.common.lock.DistributedLock;
import org.apache.commons.lang3.StringUtils;
import org.apache.curator.RetryPolicy;
import org.apache.curator.framework.CuratorFramework;
import org.apache.curator.framework.CuratorFrameworkFactory;
import org.apache.curator.framework.recipes.locks.InterProcessMutex;
import org.apache.curator.retry.ExponentialBackoffRetry;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.InitializingBean;

import java.util.Properties;
import java.util.concurrent.TimeUnit;

/**
 * Curator=E6=A1=86=E6=9E=B6=E8=87=AA=E5=B8=A6=E7=9A=84=E5=88=86=E5=B8=83=
=E5=BC=8F=E9=94=81
 * @author
 */
public class CuratorLock implements DistributedLock, InitializingBean {
    Logger logger =3D LoggerFactory.getLogger(CuratorLock.class);

    static String root =3D "/locksNode";
    static volatile CuratorFramework client;
    static ThreadLocal&lt;InterProcessMutex&gt; lockThreadLocal =3D new Thr=
eadLocal&lt;&gt;();

    @Override
    public void afterPropertiesSet() throws Exception {
        init();
    }

    public void init() throws Exception {
        if (client =3D=3D null) {
            synchronized (CuratorLock.class) {
                if (client =3D=3D null) {
                    Properties properties =3D PropertiesUtil.loadProperties=
("confcenter.properties");
                    String zkAddress =3D properties.getProperty("conf.cente=
r.zkserver");
                    if (StringUtils.isBlank(zkAddress)) {
                        logger.error("=E8=8E=B7=E5=8F=96zk=E8=BF=9E=E6=8E=
=A5=E5=9C=B0=E5=9D=80=E5=A4=B1=E8=B4=A5=EF=BC=8C=E8=AF=B7=E6=AD=A3=E7=A1=AE=
=E9=85=8D=E7=BD=AEIP[=E9=9B=86=E7=BE=A4=E5=9C=B0=E5=9D=80=E4=BB=A5=E9=80=97=
=E5=8F=B7=E9=9A=94=E5=BC=80]");
                    }
                    //=E9=87=8D=E8=AF=95=E7=AD=96=E7=95=A5=EF=BC=9A=E9=97=
=B4=E9=9A=94=E6=97=B6=E9=97=B4=E4=B8=BA1s=EF=BC=8C=E9=87=8D=E8=AF=9510=E6=
=AC=A1
                    RetryPolicy retryPolicy =3D new ExponentialBackoffRetry=
(1000, 10);
                    client =3D CuratorFrameworkFactory.newClient(zkAddress,=
 retryPolicy);
                    //=E5=BC=80=E5=90=AF=E8=BF=9E=E6=8E=A5
                    client.start();
                    logger.info("curator=E5=AE=A2=E6=88=B7=E7=AB=AF=E8=BF=
=9E=E6=8E=A5ZK=E6=88=90=E5=8A=9F");
                }
            }
        }
    }

    @Override
    public void lock(String lockName) {
        InterProcessMutex lock =3D new InterProcessMutex(client, root + "/"=
 + lockName);
        try {
            lock.acquire();
            lockThreadLocal.set(lock);
            logger.info("=E7=BA=BF=E7=A8=8B=EF=BC=9A{}=E8=8E=B7=E5=8F=96cur=
ator-zk=E9=94=81=EF=BC=9A{}=E6=88=90=E5=8A=9F", Thread.currentThread().getN=
ame(), lockName);
        } catch (Exception e) {
            logger.error("=E7=BA=BF=E7=A8=8B=EF=BC=9A{}=E8=8E=B7=E5=8F=96cu=
rator-zk=E9=94=81=EF=BC=9A{}=E5=A4=B1=E8=B4=A5", Thread.currentThread().get=
Name(), lockName);
            unLock(lockName);
            throw new RuntimeException("curator-zk=E9=94=81=EF=BC=9A" + loc=
kName + "=E6=B7=BB=E5=8A=A0=E5=A4=B1=E8=B4=A5", e);
        }
    }

    @Override
    public boolean tryLock(String lockName) {
        return tryLock(lockName, 0, TimeUnit.SECONDS);
    }

    @Override
    public boolean tryLock(String lockName, long time, TimeUnit unit) {
        boolean isLock;
        InterProcessMutex lock =3D new InterProcessMutex(client, root + "/"=
 + lockName);
        try {
            isLock =3D lock.acquire(time, unit);
            if (isLock) {
                lockThreadLocal.set(lock);
                logger.info("=E7=BA=BF=E7=A8=8B=EF=BC=9A{}=E8=8E=B7=E5=8F=
=96curator-zk=E9=94=81=EF=BC=9A{}=E6=88=90=E5=8A=9F", Thread.currentThread(=
).getName(), lockName);
            }
        } catch (Exception e) {
            logger.error("=E7=BA=BF=E7=A8=8B=EF=BC=9A{}=E8=8E=B7=E5=8F=96cu=
rator-zk=E9=94=81=EF=BC=9A{}=E5=A4=B1=E8=B4=A5", Thread.currentThread().get=
Name(), lockName);
            unLock(lockName);
            throw new RuntimeException("curator-zk=E9=94=81=EF=BC=9A" + loc=
kName + "=E6=B7=BB=E5=8A=A0=E5=A4=B1=E8=B4=A5", e);
        }
        return isLock;
    }

    @Override
    public void unLock(String lockName) {
        if (lockThreadLocal.get() !=3D null) {
            try {
                lockThreadLocal.get().release();
                logger.info("=E7=BA=BF=E7=A8=8B=EF=BC=9A{}=E9=87=8A=E6=94=
=BEcurator-zk=E9=94=81=EF=BC=9A{}=E6=88=90=E5=8A=9F", Thread.currentThread(=
).getName(), lockName);
            } catch (Exception e) {
                logger.error("=E7=BA=BF=E7=A8=8B=EF=BC=9A{}=E9=87=8A=E6=94=
=BEcurator-zk=E9=94=81=EF=BC=9A{}=E5=A4=B1=E8=B4=A5", Thread.currentThread(=
).getName(), lockName);
                throw new RuntimeException("curator-zk=E9=94=81=EF=BC=9A" +=
 lockName + "=E9=87=8A=E6=94=BE=E5=A4=B1=E8=B4=A5", e);
            } finally {
                lockThreadLocal.remove();
            }
        }
    }
}</pre>=20
</div>=20
</div>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">=20
<div class=3D"codeHeader panelHeader pdl hide-border-bottom" style=3D"borde=
r-bottom-width: 1px;">=20
<b class=3D"code-title">=E6=8E=A5=E5=85=A5=E5=8F=8A=E4=BD=BF=E7=94=A8=E6=96=
=B9=E5=BC=8F</b>=20
<span class=3D"collapse-source expand-control" style=3D"display:none;"><spa=
n class=3D"expand-control-icon icon">&nbsp;</span><span class=3D"expand-con=
trol-text">=E5=B1=95=E5=BC=80=E6=BA=90=E7=A0=81</span></span>=20
<span class=3D"collapse-spinner-wrapper"></span>=20
</div>=20
<div class=3D"codeContent panelContent pdl hide-toolbar">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence; collapse: true" data-theme=3D"Con=
fluence">&lt;!--=E5=A6=82=E6=9E=9C=E8=A6=81=E6=9B=BF=E6=8D=A2=E4=B8=BA=E5=
=88=AB=E7=9A=84=E5=8A=A0=E9=94=81=E6=96=B9=E5=BC=8F=EF=BC=8C=E5=8F=AA=E9=9C=
=80=E4=BF=AE=E6=94=B9class=E5=8D=B3=E5=8F=AF--&gt;
&lt;bean id=3D"distributedLock" class=3D"com.jd.trip.hotel.resource.common.=
lock.impl.CuratorLock"&gt;&lt;/bean&gt;


//=E8=B0=83=E7=94=A8=E6=96=B9=E5=BC=8F=EF=BC=88=E4=B8=9A=E5=8A=A1=E4=BB=A3=
=E7=A0=81=E4=B8=AD=E4=BD=BF=E7=94=A8=EF=BC=89
@Autowired
DistributedLock distributedLock;

//=E5=8A=A0=E9=94=81
distributedLock.tryLock(JimConstant.DELETE_HISTORY_LOG_SYNC)
//=E8=A7=A3=E9=94=81
distributedLock.unLock(JimConstant.DELETE_HISTORY_LOG_SYNC);</pre>=20
</div>=20
</div>
    </div>
</body>
</html>
------=_Part_2424001_1770717693.1555898367365
Content-Type: application/octet-stream
Content-Transfer-Encoding: base64
Content-Location: file:///C:/fd64e7ef48bd8918a9f1ffc8941e28cb

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
------=_Part_2424001_1770717693.1555898367365--
